<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Estoque</title>
    <style>
        h2 {
            color: red;
            padding-left: 30%;
            padding-right: auto;
        }
        body {
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            margin: 20px;
            background-color: rgb(0, 0, 0);
        }
        .container {
            max-width: 600px;
            margin: auto;            
        }
        input[type="text"], [type="number"] {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            box-sizing: border-box;
        }
        button {
            padding: 10px 20px;          
            background-color: rgb(168, 18, 18);
            color: white;
            border: none;
            cursor: pointer;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            font-size: 18px;
        }
        button:hover {
            background-color: green;
        }
        .product-list {
            margin-top: 20px;
            color: white;
            padding-left: 15px;
        }
        .product-item {
            padding: 10px;
            border-bottom: 1px solid white;
            display: inline-flex;
            justify-content: space-between;
            align-items: center;
        }
        .product-item button {
            background-color: red;
        }
        .product-item button.edit-btn {
            background-color: rgb(0, 102, 255);
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Gestor de Estoque</h2>
        <input type="text" id="nomeProduto" placeholder="Nome do Produto">
        <input type="number" id="valorProduto" placeholder="Valor">
        <input type="number" id="quantidadeProduto" placeholder="Quantidade">
        <br>
        <button onclick="adicionarProduto()">Adicionar Produto</button>
        <button onclick="calcularTotal()">Total Agregado</button>
        <p id="resultado" style="color: grey;"></p>
        <div class="product-list" id="listaProdutos">
            <!-- Lista de Produtos será preenchida dinamicamente -->
        </div>
    </div>
    <script>
        let produtos = [];

        // Carregar produtos salvos ao carregar a página
        document.addEventListener('DOMContentLoaded', () => {
            let produtosSalvos = localStorage.getItem('produtos');
            if (produtosSalvos) {
                produtos = JSON.parse(produtosSalvos);
                exibirProdutos();
            }
        });

        function salvarProdutos() {
            localStorage.setItem('produtos', JSON.stringify(produtos));
        }

        function adicionarProduto() {
            let nome = document.getElementById('nomeProduto').value;
            let valor = parseFloat(document.getElementById('valorProduto').value);
            let quantidade = parseInt(document.getElementById('quantidadeProduto').value);

            if (nome && !isNaN(valor) && !isNaN(quantidade)) {
                let id = produtos.length + 1; // Gera um ID simples para o produto
                produtos.push({ id, nome, valor, quantidade });
                salvarProdutos(); // Salvar no localStorage
                exibirProdutos();
                document.getElementById('nomeProduto').value = '';
                document.getElementById('valorProduto').value = '';
                document.getElementById('quantidadeProduto').value = '';
                document.getElementById('resultado').innerText = 'Produto adicionado com sucesso!';
                document.getElementById('resultado').style.color = '#008000';
            } else {
                document.getElementById('resultado').innerText = 'Por favor, preencha todos os campos CORRETAMENTE.';
                document.getElementById('resultado').style.color = '#FF0000';
            }
        }

        function exibirProdutos() {
            let listaProdutos = document.getElementById('listaProdutos');
            listaProdutos.innerHTML = '';
            produtos.forEach(produto => {
                let item = document.createElement('div');
                item.classList.add('product-item');
                item.innerHTML = `
                    <span>${produto.nome}: R$${produto.valor.toFixed(2)} | ${produto.quantidade}X</span>
                    <button class="edit-btn" onclick="editarProduto(${produto.id})">Editar</button>
                    <button onclick="removerProduto(${produto.id})">Remover</button>
                `;
                listaProdutos.appendChild(item);
            }); 
        }

        function editarProduto(id) {
            let produto = produtos.find(p => p.id === id);
            if (produto) {
                document.getElementById('nomeProduto').value = produto.nome;
                document.getElementById('valorProduto').value = produto.valor.toFixed(2);
                document.getElementById('quantidadeProduto').value = produto.quantidade;
                produtos = produtos.filter(p => p.id !== id); // Remove o produto da lista temporária
                salvarProdutos(); // Salvar no localStorage
                exibirProdutos(); // Atualiza a exibição da lista sem o produto editando
            }
        }

        function removerProduto(id) {
            produtos = produtos.filter(p => p.id !== id);
            salvarProdutos(); // Salvar no localStorage
            exibirProdutos();
        }

        function calcularTotal() {
            let total = produtos.reduce((acc, prod) => acc + (prod.valor * prod.quantidade), 0);
            document.getElementById('resultado').innerText = `Total agregado: R$${total.toFixed(2)}`;
            document.getElementById('resultado').style.color = '#2196F3';
        }
    </script>
</body>
</html>
